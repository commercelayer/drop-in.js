import{r as t,h as i,H as s,g as a}from"./p-f940d890.js";import{g as n,p as r,m as e,c as o,a as h,u as c,b as l,t as d,d as u,i as v}from"./p-b94594e8.js";const p=(t,...i)=>{const{debug:s}=n();"all"===s&&console[t](...i)};function w(t,i=!0){const s=[],a=(t,...i)=>{s.push([t,...i])};return a.end=()=>{p(i?"groupCollapsed":"group",t),s.forEach((t=>{p(...t)})),p("groupEnd")},a}const y=r((async t=>{const i=await o(n()),s=c(t),a=w("getSkuIds invoked");a("info","found",s.length),a("info","unique skus",s);const r=h(s,25),e=(await Promise.all(r.map((async t=>await i.skus.list({pageSize:25,filters:{code_in:t.join(",")},fields:["id","code"]}))))).flat().reduce(((t,i)=>(void 0!==i.id&&void 0!==i.code&&(t[i.code]=i.id),t)),{});return a.end(),e}),{wait:50,maxWait:100}),f=e((async t=>await y([t]).then((i=>i[t])))),m=e((async t=>{const i=await f(t);if(void 0===i)return;const s=await o(n());return await s.skus.retrieve(i)}));function g(t){return"string"==typeof t&&""!==t}function k(t,i){g(i)||p("warn",'"sku" should be a not empty string.',t)}function b(t){return t>=0}const _=class{constructor(i){t(this,i),this.sku=void 0,this.quantity=1,this.skuObject=void 0}watchSkuHandler(t,i){k(this.host,t)}watchQuantityHandler(t,i){b(t)||(this.quantity=0)}async componentWillLoad(){var t;g(this.sku)&&(this.skuObject=await m(this.sku),void 0===this.skuObject&&p("warn",`Cannot find sku ${this.sku}.`,this.host)),k(this.host,this.sku),t=this.host,b(this.quantity)||p("warn",'"quantity" should be a number equal or greater than 0.',t)}handleKeyPress(t){"Enter"!==t.key&&" "!==t.key||this.handleAddItem()}handleAddItem(){void 0!==this.sku&&this.canBeSold()&&l(this.sku,this.quantity).catch((t=>{throw t}))}canBeSold(){var t,i,s,a;return g(this.sku)&&this.quantity>0&&!0===(null===(i=null===(t=this.skuObject)||void 0===t?void 0:t.inventory)||void 0===i?void 0:i.available)&&this.quantity<=(null===(a=null===(s=this.skuObject)||void 0===s?void 0:s.inventory)||void 0===a?void 0:a.quantity)}render(){const t=this.canBeSold();return i(s,{role:"button",tabindex:"0","aria-disabled":t?void 0:"true",onKeyPress:t=>this.handleKeyPress(t),onClick:()=>this.handleAddItem()},i("slot",null))}get host(){return a(this)}static get watchers(){return{sku:["watchSkuHandler"],quantity:["watchQuantityHandler"]}}},H=class{constructor(i){t(this,i),this.sku=void 0}async componentWillLoad(){if(g(this.sku)){const t=await m(this.sku);void 0!==t&&this.updateAvailability(t)}k(this.host,this.sku)}watchPropHandler(t,i){k(this.host,t)}updateAvailability(t){this.host.querySelectorAll("cl-availability-status").forEach((i=>{i.dispatchEvent(new CustomEvent("skuUpdate",{detail:t}))}))}render(){return i("slot",null)}get host(){return a(this)}static get watchers(){return{sku:["watchPropHandler"]}}},P=class{constructor(i){t(this,i),this.type=void 0,this.available=void 0}skuUpdateHandler(t){var i;this.available=null===(i=t.detail.inventory)||void 0===i?void 0:i.available}render(){return"available"===this.type&&!0===this.available||"unavailable"===this.type&&!1===this.available?i("slot",null):i(s,{"aria-disabled":"true"})}},C=class{constructor(i){t(this,i),this.count=void 0}async componentWillLoad(){await d(null)}cartUpdateHandler(t){this.count=void 0!==t.detail.skus_count&&t.detail.skus_count>0?t.detail.skus_count:void 0}render(){return i(s,{quantity:this.count},this.count)}},W=class{constructor(i){t(this,i),this.target="_self",this.href=void 0}async componentWillLoad(){this.href=await u()}async handleClick(t){void 0!==this.href&&v(this.href)||(t.preventDefault(),this.href=await u(!0),window.open(this.href,this.target))}async cartUpdateHandler(t){void 0!==this.href&&v(this.href)||(this.href=await u())}render(){return i("a",{target:this.target,href:this.href,onClick:t=>{this.handleClick(t).catch((t=>{throw t}))}},i("slot",null))}get host(){return a(this)}},q=r((async t=>{const i=await o(n()),s=c(t),a=w("getPrices invoked");a("info","found",s.length),a("info","unique skus",s);const r=h(s,25),e=(await Promise.all(r.map((async t=>await i.prices.list({pageSize:25,filters:{sku_code_in:t.join(",")}}))))).flat().reduce(((t,i)=>(void 0!==i.sku_code&&(t[i.sku_code]=i),t)),{});return a.end(),e}),{wait:50,maxWait:100}),S=e((async t=>await q([t]).then((i=>i[t])))),U=class{constructor(i){t(this,i),this.sku=void 0}async componentWillLoad(){if(g(this.sku)){const t=await S(this.sku);void 0!==t&&this.updatePrice(t)}k(this.host,this.sku)}watchPropHandler(t,i){k(this.host,t)}updatePrice(t){this.host.querySelectorAll("cl-price-amount").forEach((i=>{i.dispatchEvent(new CustomEvent("priceUpdate",{detail:t}))}))}render(){return i("slot",null)}get host(){return a(this)}static get watchers(){return{sku:["watchPropHandler"]}}},L=class{constructor(i){t(this,i),this.type="price",this.price=void 0}priceUpdateHandler(t){switch(this.type){case"compare-at":this.price=t.detail.formatted_compare_at_amount;break;case"price":this.price=t.detail.formatted_amount}}render(){return i(s,null,"compare-at"===this.type?i("s",{part:"strikethrough"},this.price):this.price)}};export{_ as cl_add_to_cart,H as cl_availability,P as cl_availability_status,C as cl_cart_count,W as cl_cart_link,U as cl_price,L as cl_price_amount}