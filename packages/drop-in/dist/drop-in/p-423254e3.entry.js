import{r as t,h as s,H as i,g as a}from"./p-34f2dea8.js";import{g as n,p as r,m as e,c as o,a as h,u as c,b as u,t as l,d,i as w}from"./p-b94594e8.js";const p=(t,...s)=>{const{debug:i}=n();"all"===i&&console[t](...s)};function v(t,s=!0){const i=[],a=(t,...s)=>{i.push([t,...s])};return a.end=()=>{p(s?"groupCollapsed":"group",t),i.forEach((t=>{p(...t)})),p("groupEnd")},a}const g=r((async t=>{const s=await o(n()),i=c(t),a=v("getSkuIds invoked");a("info","found",i.length),a("info","unique skus",i);const r=h(i,25),e=(await Promise.all(r.map((async t=>await s.skus.list({pageSize:25,filters:{sku_code_in:t.join(",")},fields:["id","code"]}))))).flat().reduce(((t,s)=>(void 0!==s.id&&void 0!==s.code&&(t[s.code]=s.id),t)),{});return a.end(),e}),{wait:50,maxWait:100}),y=e((async t=>await g([t]).then((s=>s[t])))),k=e((async t=>{const s=await y(t);if(void 0===s)return;const i=await o(n());return await i.skus.retrieve(s)})),m=class{constructor(s){t(this,s),this.quantity=1}logSku(t){this.validateSku(t)||p("warn",'"sku" should be a not empty string.',this.host)}logQuantity(t){this.validateQuantity(t)||p("warn",'"quantity" should be a number equal or greater than 0.',this.host)}validateSku(t){return"string"==typeof t&&""!==t}validateQuantity(t){return t>=0}watchSkuHandler(t,s){this.logSku(t)}watchQuantityHandler(t,s){this.validateQuantity(t)||(this.quantity=0)}async componentWillLoad(){this.validateSku(this.sku)&&(this.skuObject=await k(this.sku),void 0===this.skuObject&&p("warn",`Cannot find sku ${this.sku}.`,this.host)),this.logSku(this.sku),this.logQuantity(this.quantity)}handleKeyPress(t){"Enter"!==t.key&&" "!==t.key||this.handleAddItem()}handleAddItem(){void 0!==this.sku&&this.canBeSold()&&u(this.sku,this.quantity).catch((t=>{throw t}))}canBeSold(){var t,s,i,a;return this.validateSku(this.sku)&&this.quantity>0&&!0===(null===(s=null===(t=this.skuObject)||void 0===t?void 0:t.inventory)||void 0===s?void 0:s.available)&&this.quantity<=(null===(a=null===(i=this.skuObject)||void 0===i?void 0:i.inventory)||void 0===a?void 0:a.quantity)}render(){const t=this.canBeSold();return s(i,{role:"button",tabindex:"0","aria-disabled":t?void 0:"true",onKeyPress:t=>this.handleKeyPress(t),onClick:()=>this.handleAddItem()},s("slot",null))}get host(){return a(this)}static get watchers(){return{sku:["watchSkuHandler"],quantity:["watchQuantityHandler"]}}},f=class{constructor(s){t(this,s)}async componentWillLoad(){await l(null)}cartUpdateHandler(t){this.count=void 0!==t.detail.skus_count&&t.detail.skus_count>0?t.detail.skus_count:void 0}render(){return s(i,{quantity:this.count},this.count)}},_=class{constructor(s){t(this,s),this.target="_self"}async componentWillLoad(){this.href=await d()}async handleClick(t){void 0!==this.href&&w(this.href)||(t.preventDefault(),this.href=await d(!0),window.open(this.href,this.target))}async cartUpdateHandler(t){void 0!==this.href&&w(this.href)||(this.href=await d())}render(){return s("a",{target:this.target,href:this.href,onClick:t=>{this.handleClick(t).catch((t=>{throw t}))}},s("slot",null))}get host(){return a(this)}},b=r((async t=>{const s=await o(n()),i=c(t),a=v("getPrices invoked");a("info","found",i.length),a("info","unique skus",i);const r=h(i,25),e=(await Promise.all(r.map((async t=>await s.prices.list({pageSize:25,filters:{sku_code_in:t.join(",")}}))))).flat().reduce(((t,s)=>(void 0!==s.sku_code&&(t[s.sku_code]=s),t)),{});return a.end(),e}),{wait:50,maxWait:100}),H=e((async t=>await b([t]).then((s=>s[t])))),S=class{constructor(s){t(this,s)}logSku(t){this.validateSku(t)||p("warn",'"sku" should be a not string.',this.host)}validateSku(t){return"string"==typeof t&&""!==t}async componentWillLoad(){if(this.validateSku(this.sku)){const t=await H(this.sku);void 0!==t&&this.updatePrice(t)}this.logSku(this.sku)}watchPropHandler(t,s){this.logSku(t)}updatePrice(t){this.host.querySelectorAll("cl-price-amount").forEach((s=>{s.dispatchEvent(new CustomEvent("priceUpdate",{detail:t}))}))}render(){return s("slot",null)}get host(){return a(this)}static get watchers(){return{sku:["watchPropHandler"]}}},P=class{constructor(s){t(this,s),this.type="price"}priceUpdateHandler(t){switch(this.type){case"compare-at":this.price=t.detail.formatted_compare_at_amount;break;case"price":this.price=t.detail.formatted_amount}}render(){return s(i,null,"compare-at"===this.type?s("s",{part:"strikethrough"},this.price):this.price)}};export{m as cl_add_to_cart,f as cl_cart_count,_ as cl_cart_link,S as cl_price,P as cl_price_amount}