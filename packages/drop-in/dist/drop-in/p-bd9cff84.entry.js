import{r as t,h as a,H as s,g as n}from"./p-96204dd9.js";import{j as i,b as r,g as e,d as l,a as o,l as c}from"./p-accd036a.js";async function u(){const t=await o(e()),a=await t.orders.create({});var s;return s=a.id,i.set(r(),s),await w(a),a}function h(){var t;return null!==(t=i.get(r()))&&void 0!==t?t:null}async function d(t=!1){const a=e(),s=await l(a);let n=h();return null===n&&t&&(n=(await u()).id),`https://${a.slug}.commercelayer.app/cart/${null!=n?n:"null"}?accessToken=${s}`}async function w(t){if(null===t){const t=await async function(){const t=await o(e()),a=h();if(null===a)return null;const s=await t.orders.retrieve(a).catch((()=>null));return await w(s),s}();null!==t&&window.dispatchEvent(new CustomEvent("cartUpdate",{detail:t}))}else window.dispatchEvent(new CustomEvent("cartUpdate",{detail:t}))}const p=class{constructor(a){t(this,a),this.quantity=1}logSku(t){this.validateSku(t)||c("warn",'"sku" should be a not empty string.',this.host)}logQuantity(t){this.validateQuantity(t)||c("warn",'"quantity" should be a number equal or greater than 0.',this.host)}validateSku(t){return"string"==typeof t&&""!==t}validateQuantity(t){return t>=0}watchSkuHandler(t,a){this.logSku(t)}watchQuantityHandler(t,a){this.validateQuantity(t)||(this.quantity=0)}componentWillLoad(){this.logSku(this.sku),this.logQuantity(this.quantity)}handleKeyPress(t){"Enter"!==t.key&&" "!==t.key||this.handleAddItem()}handleAddItem(){void 0!==this.sku&&this.canBeSold()&&async function(t,a){var s;const n=await o(e()),i=null!==(s=h())&&void 0!==s?s:await(await u()).id;await n.line_items.create({order:{id:i,type:"orders"},quantity:a,sku_code:t,_update_quantity:!0}),await w(null)}(this.sku,this.quantity).catch((t=>{throw t}))}canBeSold(){return this.validateSku(this.sku)&&this.quantity>0}render(){const t=this.canBeSold();return a(s,{role:"button",tabindex:"0","aria-disabled":t?void 0:"true",onKeyPress:t=>this.handleKeyPress(t),onClick:()=>this.handleAddItem()},a("slot",null))}get host(){return n(this)}static get watchers(){return{sku:["watchSkuHandler"],quantity:["watchQuantityHandler"]}}},y=class{constructor(a){t(this,a)}async componentWillLoad(){await w(null)}cartUpdateHandler(t){void 0!==t.detail.skus_count&&t.detail.skus_count>0&&(this.count=t.detail.skus_count)}render(){return a(s,{quantity:this.count},this.count)}},m=class{constructor(a){t(this,a),this.target="_self"}async componentWillLoad(){this.href=await d()}async handleClick(t){void 0!==this.href&&function(t){const a=h();return null!==a&&t.includes(`/${a}?`)}(this.href)||(t.preventDefault(),this.href=await d(!0),window.open(this.href,this.target))}render(){return a("a",{target:this.target,href:this.href,onClick:t=>{this.handleClick(t).catch((t=>{throw t}))}},a("slot",null))}get host(){return n(this)}},k=class{constructor(a){t(this,a)}logSku(t){this.validateSku(t)||c("warn",'"sku" should be a not string.',this.host)}validateSku(t){return"string"==typeof t&&""!==t}componentWillLoad(){this.logSku(this.sku)}watchPropHandler(t,a){this.logSku(t)}priceUpdateHandler({type:t,detail:a}){this.host.querySelectorAll("cl-price-amount").forEach((s=>{s.dispatchEvent(new CustomEvent(t,{detail:a}))}))}render(){return a("slot",null)}get host(){return n(this)}static get watchers(){return{sku:["watchPropHandler"]}}},g=class{constructor(a){t(this,a),this.type="price"}priceUpdateHandler(t){switch(this.type){case"compare-at":this.price=t.detail.formatted_compare_at_amount;break;case"price":this.price=t.detail.formatted_amount}}render(){return a(s,null,"compare-at"===this.type?a("s",{part:"strikethrough"},this.price):this.price)}};export{p as cl_add_to_cart,y as cl_cart_count,m as cl_cart_link,k as cl_price,g as cl_price_amount}