import{r as t,h as i,H as s,g as a}from"./p-f940d890.js";import{g as n,p as o,m as r,c as e,a as l,u as h,b as d,t as c,d as u,i as v}from"./p-b94594e8.js";const p=(t,...i)=>{const{debug:s}=n();"all"===s&&console[t](...i)};function w(t,i=!0){const s=[],a=(t,...i)=>{s.push([t,...i])};return a.end=()=>{p(i?"groupCollapsed":"group",t),s.forEach((t=>{p(...t)})),p("groupEnd")},a}const y=o((async t=>{const i=await e(n()),s=h(t),a=w("getSkuIds invoked");a("info","found",s.length),a("info","unique skus",s);const o=l(s,25),r=(await Promise.all(o.map((async t=>await i.skus.list({pageSize:25,filters:{code_in:t.join(",")},fields:["id","code"]}))))).flat().reduce(((t,i)=>(void 0!==i.id&&void 0!==i.code&&(t[i.code]=i.id),t)),{});return a.end(),r}),{wait:50,maxWait:100}),g=r((async t=>await y([t]).then((i=>i[t])))),m=r((async t=>{const i=await g(t);if(void 0===i)return;const s=await e(n());return await s.skus.retrieve(i)}));function f(t){return"string"==typeof t&&""!==t}function k(t,i){f(i)||p("warn",'"sku" should be a not empty string.',t)}function _(t){return t>=0}const b=class{constructor(i){t(this,i),this.sku=void 0,this.quantity=1,this.skuObject=void 0}watchSkuHandler(t,i){k(this.host,t)}watchQuantityHandler(t,i){_(t)||(this.quantity=0)}async componentWillLoad(){var t;f(this.sku)&&(this.skuObject=await m(this.sku),void 0===this.skuObject&&p("warn",`Cannot find sku ${this.sku}.`,this.host)),k(this.host,this.sku),t=this.host,_(this.quantity)||p("warn",'"quantity" should be a number equal or greater than 0.',t)}handleKeyPress(t){"Enter"!==t.key&&" "!==t.key||this.handleAddItem()}handleAddItem(){void 0!==this.sku&&this.canBeSold()&&d(this.sku,this.quantity).catch((t=>{throw t}))}canBeSold(){var t,i,s,a;return f(this.sku)&&this.quantity>0&&!0===(null===(i=null===(t=this.skuObject)||void 0===t?void 0:t.inventory)||void 0===i?void 0:i.available)&&this.quantity<=(null===(a=null===(s=this.skuObject)||void 0===s?void 0:s.inventory)||void 0===a?void 0:a.quantity)}render(){const t=this.canBeSold();return i(s,{role:"button",tabindex:"0","aria-disabled":t?void 0:"true",onKeyPress:t=>this.handleKeyPress(t),onClick:()=>this.handleAddItem()},i("slot",null))}get host(){return a(this)}static get watchers(){return{sku:["watchSkuHandler"],quantity:["watchQuantityHandler"]}}},H=class{constructor(i){t(this,i),this.sku=void 0}async componentWillLoad(){if(f(this.sku)){const t=await m(this.sku);void 0!==t&&this.updateAvailability(t)}k(this.host,this.sku)}watchPropHandler(t,i){k(this.host,t)}updateAvailability(t){this.host.querySelectorAll("cl-availability-status, cl-availability-message").forEach((i=>{i.dispatchEvent(new CustomEvent("skuUpdate",{detail:t}))}))}render(){return i("slot",null)}get host(){return a(this)}static get watchers(){return{sku:["watchPropHandler"]}}},P=class{constructor(i){t(this,i),this.format=void 0,this.message=void 0,this.displayMessage=void 0}skuUpdateHandler(t){var i,s;if(void 0===this.format||void 0===this.message)return;const a=null===(s=null===(i=t.detail.inventory)||void 0===i?void 0:i.levels[0])||void 0===s?void 0:s.delivery_lead_times[0];if(void 0===a)return;const n=a.min[this.format],o=a.max[this.format];void 0!==n&&void 0!==o&&(this.displayMessage=this.message.replace(/\{min\}/g,n.toFixed(0)).replace(/\{max\}/g,o.toFixed(0)))}render(){return i(s,null,this.displayMessage)}},C=class{constructor(i){t(this,i),this.type=void 0,this.available=void 0}skuUpdateHandler(t){var i;this.available=null===(i=t.detail.inventory)||void 0===i?void 0:i.available}render(){return"available"===this.type&&!0===this.available||"unavailable"===this.type&&!1===this.available?i("slot",null):i(s,{"aria-disabled":"true"})}},U=class{constructor(i){t(this,i),this.count=void 0}async componentWillLoad(){await c(null)}cartUpdateHandler(t){this.count=void 0!==t.detail.skus_count&&t.detail.skus_count>0?t.detail.skus_count:void 0}render(){return i(s,{quantity:this.count},this.count)}},W=class{constructor(i){t(this,i),this.target="_self",this.href=void 0}async componentWillLoad(){this.href=await u()}async handleClick(t){void 0!==this.href&&v(this.href)||(t.preventDefault(),this.href=await u(!0),window.open(this.href,this.target))}async cartUpdateHandler(t){void 0!==this.href&&v(this.href)||(this.href=await u())}render(){return i("a",{target:this.target,href:this.href,onClick:t=>{this.handleClick(t).catch((t=>{throw t}))}},i("slot",null))}get host(){return a(this)}},q=o((async t=>{const i=await e(n()),s=h(t),a=w("getPrices invoked");a("info","found",s.length),a("info","unique skus",s);const o=l(s,25),r=(await Promise.all(o.map((async t=>await i.prices.list({pageSize:25,filters:{sku_code_in:t.join(",")}}))))).flat().reduce(((t,i)=>(void 0!==i.sku_code&&(t[i.sku_code]=i),t)),{});return a.end(),r}),{wait:50,maxWait:100}),S=r((async t=>await q([t]).then((i=>i[t])))),x=class{constructor(i){t(this,i),this.sku=void 0}async componentWillLoad(){if(f(this.sku)){const t=await S(this.sku);void 0!==t&&this.updatePrice(t)}k(this.host,this.sku)}watchPropHandler(t,i){k(this.host,t)}updatePrice(t){this.host.querySelectorAll("cl-price-amount").forEach((i=>{i.dispatchEvent(new CustomEvent("priceUpdate",{detail:t}))}))}render(){return i("slot",null)}get host(){return a(this)}static get watchers(){return{sku:["watchPropHandler"]}}},L=class{constructor(i){t(this,i),this.type="price",this.price=void 0}priceUpdateHandler(t){this.price=t.detail}render(){var t,a,n,o;const r=(null===(t=this.price)||void 0===t?void 0:t.formatted_compare_at_amount)!==(null===(a=this.price)||void 0===a?void 0:a.formatted_amount);return i(s,null,"compare-at"===this.type?r&&i("s",{part:"strikethrough"},null===(n=this.price)||void 0===n?void 0:n.formatted_compare_at_amount):null===(o=this.price)||void 0===o?void 0:o.formatted_amount)}};export{b as cl_add_to_cart,H as cl_availability,P as cl_availability_message,C as cl_availability_status,U as cl_cart_count,W as cl_cart_link,x as cl_price,L as cl_price_amount}